<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>精英之路</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,minimal-ui"/>
    <meta name="format-detection" content="telephone=no">
    <!-- 在 meta 标签中进行基础分享信息设置 End-->
    <link rel="stylesheet" href="../css/style-index.css"/>
</head>

<body>
<canvas id="canvas"></canvas>
<div id="orientLayer" class="mod-orient-layer">
    <div class="mod-orient-layer__content">
        <i class="icon mod-orient-layer__icon-orient"></i>
        <div class="mod-orient-layer__desc">为了更好的体验，请使用竖屏浏览</div>
    </div>
</div>
<script>
    var canvas = document.getElementById("canvas");
    var ctx = canvas.getContext("2d");
    var width = window.innerWidth;
    var height = window.innerHeight;
    var canvasDeploy = {
        fLen: 600
    };
    var sparkle = new Image();
    var slices = [];
    sparkle.onload = function () {
        init();
    };
    sparkle.src = "../img/test.png";

    //canvas高清屏适配;
    function autoPixelRatio() {
        var pixelRatio = window.devicePixelRatio || 1;
        canvas.width = width * pixelRatio;
        canvas.height = height * pixelRatio;
        ctx.scale(pixelRatio, pixelRatio);
    }

    function Slice() {

        this.scale = 0.3 + Math.random()*0.7;
        this.vRotate = Math.random()*0.006-0.003;
        this.vx = -1 + Math.random()*2;
        this.vy = -1 + (-Math.random()*1);
        this.rotate = Math.random()*Math.PI*2;
        this.x = Math.random()*width + this.scale*25;
        this.y = (1+Math.random()*0.5)*height + this.scale*25;
    }

    Slice.prototype.update = function () {
        this.vx += (Math.random()*0.2 - 0.1);
        this.x += this.vx;
        this.y += this.vy;
        this.rotate += this.vRotate;
    };

    Slice.prototype.draw = function () {
        ctx.save();
        ctx.translate(this.x,this.y);
        ctx.rotate(this.rotate);
        ctx.drawImage(sparkle, this.scale*25, this.scale*25, this.scale*50, this.scale*50);
        ctx.restore();
    };


    function loop() {
        ctx.clearRect(0,0,width,height);
        for(var i = 0; i < slices.length; i++){
            var slice = slices[i];
            if((slice.x)<0||slice.x>width||slice.y<0){
                slices.splice(i,1);
                slice = new Slice();
                slices.push(slice);
            }else {
                slice.update();
                slice.draw();
            }
        }
        requestAnimationFrame(loop);
    }

    function init() {
        autoPixelRatio();
        for(var i =0 ; i< 50; i++){
            var slice = new Slice();
            slices.push(slice);
        }
        loop();
    }



</script>

</body>
</html>
